{
  "agent": {
    "metrics_collection_interval": 60,
    "run_as_user": "root",
    "region": "eu-central-1"
  },
  "logs": {
    "force_flush_interval": 5,
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/nginx/access.log",
            "log_group_name": "parallel-#ENV#-nginx",
            "log_stream_name": "access.log",
            "retention_in_days": -1,
            "timestamp_format": "%d/%b/%Y:%H:%M:%S %z"
          },
          {
            "file_path": "/var/log/nginx/error.log",
            "log_group_name": "parallel-#ENV#-nginx",
            "log_stream_name": "error.log",
            "retention_in_days": -1,
            "timestamp_format": "%Y/%m/%d %H:%M:%S"
          },
          {
            "file_path": "/var/log/modsec_audit.log",
            "log_group_name": "parallel-#ENV#-nginx",
            "log_stream_name": "modsec_audit.log",
            "retention_in_days": -1,
            "timestamp_format": "%d/%b/%Y:%H:%M:%S %z"
          }
        ]
      }
    }
  },
  "metrics": {
    "aggregation_dimensions": [
      [
        "InstanceId"
      ],
      [
        "Environment",
        "Release"
      ]
    ],
    "append_dimensions": {
      "AutoScalingGroupName": "${aws:AutoScalingGroupName}",
      "ImageId": "${aws:ImageId}",
      "InstanceId": "${aws:InstanceId}",
      "InstanceType": "${aws:InstanceType}",
      "Environment": "#ENV#",
      "Release": "#RELEASE#",
      "InstanceNumber": "#INSTANCE_NUMBER#"
    },
    "metrics_collected": {
      "collectd": {
        "metrics_aggregation_interval": 60
      },
      "cpu": {
        "measurement": [
          "cpu_usage_nice"
        ],
        "metrics_collection_interval": 60,
        "totalcpu": false
      },
      "disk": {
        "measurement": [
          "used_percent"
        ],
        "metrics_collection_interval": 60,
        "resources": [
          "/"
        ]
      },
      "mem": {
        "measurement": [
          "mem_used_percent"
        ],
        "metrics_collection_interval": 60
      },
      "statsd": {
        "metrics_aggregation_interval": 60,
        "metrics_collection_interval": 10,
        "service_address": ":8125"
      },
      "procstat": [
        {
          "pid_file": "/var/run/nginx.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "nginx"
          }
        },
        {
          "pid_file": "/var/run/parallel-server.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-server"
          }
        },
        {
          "pid_file": "/var/run/parallel-client.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-client"
          }
        },
        {
          "pid_file": "/var/run/parallel-email-events-queue.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-email-events-queue"
          }
        },
        {
          "pid_file": "/var/run/parallel-email-sender-queue.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-email-sender-queue"
          }
        },
        {
          "pid_file": "/var/run/parallel-event-processor-queue.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-event-processor-queue"
          }
        },
        {
          "pid_file": "/var/run/parallel-signature-worker-queue.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-signature-worker-queue"
          }
        },
        {
          "pid_file": "/var/run/parallel-task-worker-queue1.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-task-worker-queue1"
          }
        },
        {
          "pid_file": "/var/run/parallel-task-worker-queue2.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-task-worker-queue2"
          }
        },
        {
          "pid_file": "/var/run/parallel-task-worker-queue3.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-task-worker-queue3"
          }
        },
        {
          "pid_file": "/var/run/parallel-delay-queue-queue.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-delay-queue-queue"
          }
        },
        {
          "pid_file": "/var/run/parallel-reminder-trigger-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-reminder-trigger-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-scheduled-trigger-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-scheduled-trigger-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-petition-notifications-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-petition-notifications-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-organization-limits-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-organization-limits-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-anonymizer-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-anonymizer-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-old-notifications-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-old-notifications-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-expiring-properties-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-expiring-properties-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-background-check-monitor-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-background-check-monitor-cron"
          }
        },
        {
          "pid_file": "/var/run/parallel-adverse-media-monitor-cron.pid",
          "measurement": [
            "cpu_usage",
            "memory_rss"
          ],
          "metrics_collection_interval": 10,
          "append_dimensions": {
            "Process": "parallel-adverse-media-monitor-cron"
          }
        }
      ]
    }
  }
}